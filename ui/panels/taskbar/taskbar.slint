import { Clock, ClockState } from "clock.slint";
import { Battery, BatteryData, BatteryState } from "battery.slint";
import { Volume } from "volume.slint";
import {
    MaterialPalette,
} from "../../../material-1.0/ui/styling/material_palette.slint";
import { Palette } from "std-widgets.slint";


export component Taskbar inherits Window {
    init => {
        Palette.color-scheme = ColorScheme.dark; // move this to rust when user config is implemented
    }

    // State properties
    in-out property <ClockState> clock-state: {
        time: "00:00",
        date: "Mon, Jan 1",
    };

    in-out property <BatteryData> battery-data: {
        percentage: 0,
        state: BatteryState.Unknown,
        time_remaining: "",
    };

    in-out property <int> volume: 0;

    // Whether a battery is present on the system
    in-out property <bool> has-battery: false;

    // Callbacks
    callback update-clock();
    callback update-battery();
    
    // Timer to update clock every second
    Timer {
        interval: 1s;
        running: true;
        triggered => {
            root.update-clock();
        }
    }

    // Main window styling
    background: MaterialPalette.surface;
    height: 48px;

    // Main layout: 3-section row (left | center | right)
    HorizontalLayout {
        padding-left: 8px;
        padding-right: 8px;
        spacing: 8px;

        // === LEFT SECTION ===
        // (Future: App menu, workspaces, etc.)
        Rectangle {
            horizontal-stretch: 1;
            // Placeholder for left-aligned items
        }

        // === CENTER SECTION ===
        // (Future: Window title, media controls, etc.)
        // Currently empty - items will go here

        // === RIGHT SECTION ===
        HorizontalLayout {
            spacing: 8px;
            alignment: end;

            if root.has-battery: Battery {
                data: root.battery-data;
            }

            Clock {
                state: root.clock-state;
            }

            Volume {
                volume: root.volume;
            }
        }
    }
}
